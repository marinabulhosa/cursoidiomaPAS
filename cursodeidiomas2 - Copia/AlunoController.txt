package controller;

import dao.AlunoDAO;
import model.Aluno;
import util.AlertUtil;

import java.util.List;

/**
 * Controller responsável pela lógica de negócio dos alunos.
 */
public class AlunoController {

    private AlunoDAO dao = new AlunoDAO();

    // Salva um novo aluno
    public void salvar(Aluno aluno) {
        try {
            dao.salvar(aluno);
        } catch (Exception e) {
            AlertUtil.exibirErro("Erro ao salvar aluno: " + e.getMessage());
        }
    }

    // Lista todos os alunos
    public List<Aluno> listar() {
        try {
            return dao.listar();
        } catch (Exception e) {
            AlertUtil.exibirErro("Erro ao listar alunos: " + e.getMessage());
            return List.of(); // retorna lista vazia em caso de erro
        }
    }

    // Atualiza um aluno existente
    public void atualizar(Aluno aluno) {
        try {
            dao.atualizar(aluno);
        } catch (Exception e) {
            AlertUtil.exibirErro("Erro ao atualizar aluno: " + e.getMessage());
        }
    }

    // Exclui um aluno pela matrícula
    public void excluir(String matricula) {
        try {
            dao.excluir(matricula);
        } catch (Exception e) {
            AlertUtil.exibirErro("Erro ao excluir aluno: " + e.getMessage());
        }
    }

    // Busca um aluno pela matrícula
    public Aluno buscarPorMatricula(String matricula) {
        try {
            return dao.buscarPorMatricula(matricula);
        } catch (Exception e) {
            AlertUtil.exibirErro("Erro ao buscar aluno: " + e.getMessage());
            return null;
        }
    }
}
